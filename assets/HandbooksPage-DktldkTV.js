import{d as C,l as $,o as a,k as N,e as B,j as m,a as e,c as l,m as b,t as i,i as h,F as y,h as c,q as M,v as p,p as S}from"./index-BnoIOtV8.js";import{_ as I}from"./ManagerLayout.vue_vue_type_script_setup_true_lang-B6YqwWYP.js";const P={class:"px-4 py-6 sm:px-0"},j={class:"grid grid-cols-1 gap-6"},z={class:"px-4 py-5 sm:p-6 flex justify-between items-start"},H={class:"text-lg font-medium text-gray-900"},T={class:"mt-1 text-sm text-gray-500"},A={class:"text-sm text-gray-500"},D={class:"text-xs text-gray-400 mt-2"},U={key:0,class:"mt-3"},V={class:"text-xs mt-1 text-blue-600 break-all"},F=["href"],O={class:"text-xs text-gray-400"},E={key:1,class:"mt-3"},L={class:"flex flex-col space-y-2"},q=["onClick"],J={key:0,class:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4"},G={class:"bg-white rounded-lg max-w-lg w-full p-6"},K={class:"space-y-4"},Q=["value"],R={class:"mt-6 flex justify-end space-x-3"},Z=C({__name:"HandbooksPage",setup(W){const g=m([]),x=m([]),d=m(!1),s=S({templateId:"",clientName:"",accountManager:"",notes:""}),u=async()=>{const n=localStorage.getItem("token"),t="https://20nfauw0la.execute-api.ap-northeast-2.amazonaws.com/".replace(/\/$/,""),o=await fetch(`${t}/manager/handbooks`,{headers:{Authorization:`Bearer ${n}`}});o.ok&&(g.value=await o.json())},k=async()=>{const n=localStorage.getItem("token"),t="https://20nfauw0la.execute-api.ap-northeast-2.amazonaws.com/".replace(/\/$/,""),o=await fetch(`${t}/manager/templates`,{headers:{Authorization:`Bearer ${n}`}});o.ok&&(x.value=await o.json())},w=()=>{s.clientName="",s.notes="",s.accountManager="",k(),d.value=!0},v=async()=>{const n=localStorage.getItem("token"),t="https://20nfauw0la.execute-api.ap-northeast-2.amazonaws.com/".replace(/\/$/,"");(await fetch(`${t}/manager/handbooks`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify(s)})).ok?(d.value=!1,u()):alert("Failed to create handbook")},_=async n=>{if(!confirm("Publishing will deduct points. Continue?"))return;const t=localStorage.getItem("token"),o="https://20nfauw0la.execute-api.ap-northeast-2.amazonaws.com/".replace(/\/$/,""),r=await fetch(`${o}/manager/handbooks/${n}/publish`,{method:"POST",headers:{Authorization:`Bearer ${t}`}});if(r.ok)alert("Published Successfully!"),u();else{const f=await r.text();alert("Failed: "+f)}};return $(u),(n,t)=>(a(),N(I,null,{default:B(()=>[e("div",P,[e("div",{class:"flex justify-between items-center mb-6"},[t[5]||(t[5]=e("h1",{class:"text-2xl font-bold text-gray-900"},"Handbooks",-1)),e("button",{onClick:w,class:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700"},"Create New Handbook")]),e("div",j,[(a(!0),l(y,null,b(g.value,o=>{var r;return a(),l("div",{key:o._id,class:"bg-white overflow-hidden shadow rounded-lg hover:shadow-md transition-shadow"},[e("div",z,[e("div",null,[e("h3",H,i(o.clientName),1),e("p",T,"Template: "+i((r=o.template)==null?void 0:r.title),1),e("p",A,"AM: "+i(o.accountManager),1),e("p",D,"Notes: "+i(o.notes),1),o.isPublished?(a(),l("div",U,[t[6]||(t[6]=e("span",{class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"},"Published",-1)),e("p",V,[e("a",{href:"http://localhost:5173/#/"+o.publishedUrlId,target:"_blank"}," http://localhost:5173/#/"+i(o.publishedUrlId),9,F)]),e("p",O,"Expires: "+i(new Date(o.expiryDate).toLocaleDateString()),1)])):(a(),l("div",E,[...t[7]||(t[7]=[e("span",{class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800"},"Draft",-1)])]))]),e("div",L,[o.isPublished?h("",!0):(a(),l("button",{key:0,onClick:f=>_(o._id),class:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700"},"Publish",8,q))])])])}),128))]),d.value?(a(),l("div",J,[e("div",G,[t[12]||(t[12]=e("h3",{class:"text-lg font-medium mb-4"},"Create New Handbook",-1)),e("div",K,[e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700"},"Select Template",-1)),c(e("select",{"onUpdate:modelValue":t[0]||(t[0]=o=>s.templateId=o),class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"},[(a(!0),l(y,null,b(x.value,o=>(a(),l("option",{key:o._id,value:o._id},i(o.title),9,Q))),128))],512),[[M,s.templateId]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700"},"Client Name",-1)),c(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>s.clientName=o),type:"text",class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"},null,512),[[p,s.clientName]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700"},"Account Manager",-1)),c(e("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>s.accountManager=o),type:"text",class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"},null,512),[[p,s.accountManager]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700"},"Notes",-1)),c(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=o=>s.notes=o),class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"},null,512),[[p,s.notes]])])]),e("div",R,[e("button",{onClick:t[4]||(t[4]=o=>d.value=!1),class:"bg-white py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50"},"Cancel"),e("button",{onClick:v,class:"bg-indigo-600 py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white hover:bg-indigo-700"},"Create")])])])):h("",!0)])]),_:1}))}});export{Z as default};

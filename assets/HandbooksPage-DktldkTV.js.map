{"version":3,"file":"HandbooksPage-DktldkTV.js","sources":["../../src/pages/cms/HandbooksPage.vue"],"sourcesContent":["<template>\n  <ManagerLayout>\n    <div class=\"px-4 py-6 sm:px-0\">\n      <div class=\"flex justify-between items-center mb-6\">\n        <h1 class=\"text-2xl font-bold text-gray-900\">Handbooks</h1>\n        <button @click=\"openCreateModal\" class=\"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700\">Create New Handbook</button>\n      </div>\n\n      <div class=\"grid grid-cols-1 gap-6\">\n        <div v-for=\"hb in handbooks\" :key=\"hb._id\" class=\"bg-white overflow-hidden shadow rounded-lg hover:shadow-md transition-shadow\">\n          <div class=\"px-4 py-5 sm:p-6 flex justify-between items-start\">\n            <div>\n              <h3 class=\"text-lg font-medium text-gray-900\">{{ hb.clientName }}</h3>\n              <p class=\"mt-1 text-sm text-gray-500\">Template: {{ hb.template?.title }}</p>\n              <p class=\"text-sm text-gray-500\">AM: {{ hb.accountManager }}</p>\n              <p class=\"text-xs text-gray-400 mt-2\">Notes: {{ hb.notes }}</p>\n              \n              <div v-if=\"hb.isPublished\" class=\"mt-3\">\n                 <span class=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800\">Published</span>\n                 <p class=\"text-xs mt-1 text-blue-600 break-all\">\n                   <a :href=\"'http://localhost:5173/#/' + hb.publishedUrlId\" target=\"_blank\">\n                     http://localhost:5173/#/{{ hb.publishedUrlId }}\n                   </a>\n                 </p>\n                 <p class=\"text-xs text-gray-400\">Expires: {{ new Date(hb.expiryDate).toLocaleDateString() }}</p>\n              </div>\n              <div v-else class=\"mt-3\">\n                <span class=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800\">Draft</span>\n              </div>\n            </div>\n            \n            <div class=\"flex flex-col space-y-2\">\n              <button @click=\"publishHandbook(hb._id)\" v-if=\"!hb.isPublished\" class=\"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700\">Publish</button>\n              <!-- Future: Edit Handbook Metadata -->\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Create Modal -->\n      <div v-if=\"showModal\" class=\"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4\">\n        <div class=\"bg-white rounded-lg max-w-lg w-full p-6\">\n          <h3 class=\"text-lg font-medium mb-4\">Create New Handbook</h3>\n          <div class=\"space-y-4\">\n            <div>\n              <label class=\"block text-sm font-medium text-gray-700\">Select Template</label>\n              <select v-model=\"newHandbook.templateId\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n                <option v-for=\"t in templates\" :key=\"t._id\" :value=\"t._id\">{{ t.title }}</option>\n              </select>\n            </div>\n            <div>\n              <label class=\"block text-sm font-medium text-gray-700\">Client Name</label>\n              <input v-model=\"newHandbook.clientName\" type=\"text\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n            </div>\n            <div>\n              <label class=\"block text-sm font-medium text-gray-700\">Account Manager</label>\n              <input v-model=\"newHandbook.accountManager\" type=\"text\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\">\n            </div>\n            <div>\n              <label class=\"block text-sm font-medium text-gray-700\">Notes</label>\n              <textarea v-model=\"newHandbook.notes\" class=\"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"></textarea>\n            </div>\n          </div>\n          <div class=\"mt-6 flex justify-end space-x-3\">\n            <button @click=\"showModal = false\" class=\"bg-white py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50\">Cancel</button>\n            <button @click=\"createHandbook\" class=\"bg-indigo-600 py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white hover:bg-indigo-700\">Create</button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </ManagerLayout>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, onMounted, reactive } from 'vue';\nimport ManagerLayout from '@/layouts/ManagerLayout.vue';\n\nconst handbooks = ref<any[]>([]);\nconst templates = ref<any[]>([]);\nconst showModal = ref(false);\n\nconst newHandbook = reactive({\n  templateId: '',\n  clientName: '',\n  accountManager: '',\n  notes: ''\n});\n\nconst fetchHandbooks = async () => {\n  const token = localStorage.getItem('token');\n  const apiBase = (import.meta.env.VITE_API_BASE_URL || 'http://localhost:3000').replace(/\\/$/, '');\n  const res = await fetch(`${apiBase}/manager/handbooks`, {\n    headers: { 'Authorization': `Bearer ${token}` }\n  });\n  if (res.ok) {\n    handbooks.value = await res.json();\n  }\n};\n\nconst fetchTemplates = async () => {\n  const token = localStorage.getItem('token');\n  const apiBase = (import.meta.env.VITE_API_BASE_URL || 'http://localhost:3000').replace(/\\/$/, '');\n  const res = await fetch(`${apiBase}/manager/templates`, {\n    headers: { 'Authorization': `Bearer ${token}` }\n  });\n  if (res.ok) {\n    templates.value = await res.json();\n  }\n};\n\nconst openCreateModal = () => {\n  newHandbook.clientName = '';\n  newHandbook.notes = '';\n  newHandbook.accountManager = '';\n  fetchTemplates();\n  showModal.value = true;\n};\n\nconst createHandbook = async () => {\n  const token = localStorage.getItem('token');\n  const apiBase = (import.meta.env.VITE_API_BASE_URL || 'http://localhost:3000').replace(/\\/$/, '');\n  const res = await fetch(`${apiBase}/manager/handbooks`, {\n    method: 'POST',\n    headers: { \n      'Content-Type': 'application/json',\n      'Authorization': `Bearer ${token}` \n    },\n    body: JSON.stringify(newHandbook)\n  });\n\n  if (res.ok) {\n    showModal.value = false;\n    fetchHandbooks();\n  } else {\n    alert('Failed to create handbook');\n  }\n};\n\nconst publishHandbook = async (id: string) => {\n  if (!confirm('Publishing will deduct points. Continue?')) return;\n  \n  const token = localStorage.getItem('token');\n  const apiBase = (import.meta.env.VITE_API_BASE_URL || 'http://localhost:3000').replace(/\\/$/, '');\n  const res = await fetch(`${apiBase}/manager/handbooks/${id}/publish`, {\n    method: 'POST',\n    headers: { 'Authorization': `Bearer ${token}` }\n  });\n\n  if (res.ok) {\n    alert('Published Successfully!');\n    fetchHandbooks();\n  } else {\n    const msg = await res.text();\n    alert('Failed: ' + msg);\n  }\n};\n\nonMounted(fetchHandbooks);\n</script>"],"names":["handbooks","ref","templates","showModal","newHandbook","reactive","fetchHandbooks","token","apiBase","res","fetchTemplates","openCreateModal","createHandbook","publishHandbook","id","msg","onMounted","_createBlock","ManagerLayout","_createElementVNode","_hoisted_1","_cache","_hoisted_2","_createElementBlock","_Fragment","_renderList","hb","_hoisted_3","_hoisted_4","_toDisplayString","_hoisted_5","_a","_hoisted_6","_hoisted_7","_openBlock","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","$event","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","t","_hoisted_18","_vModelSelect","_vModelText","_hoisted_19"],"mappings":"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"}